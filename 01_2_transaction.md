# Transaction이란?
### Transaction이란?

데이터베이스의 상태를 변경시키기위해 수행하는 **작업의 단위**.

즉, 한번에 수행되어야할 일련의 작업들을 의미한다.

<br>
<hr>

# Transaction의 성질 (ACID)

### 1. Atomicity (원자성)

트랜잭션은 DB에 모두 반영되거나, 전혀 반영되지 않아야 한다.<br>
다시 말해 끝까지 처리되지 않은 트랜잭션은 도중에 DB에 반영되면 안된다.
`All Commit, All Rollback`

<br>

### 2. Consistency (일관성)

트랜잭션 작업처리의 결과는 항상 일관성이 있어야 한다.<br>
[제약조건을 위배하지 않아야 한다.]

<br>

### 3. Isolation (독립성)

둘 이상의 트랜잭션이 동시 실행되고 있을 때, 다른 트랜잭션이 이 연산에 끼어들 수 없다.

<br>

### 4. Durability (지속성)

트랜잭션이 성공한 경우, 그 결과는 영구히 반영되어야 한다.

<br>
<hr>

# Transaction 격리 수준

* ACID 성질을 모두 엄격하게 만족시킨다면 동시성이 매우 떨어진다.
* Transaction 격리 수준은 동시에 DB에 접근할 때 어떻게 제어할지에 대한 설정
* 아래로 갈수록 동시성은 떨어지고, 데이터 정합성은 보장된다.

<br>

### 1. READ-UNCOMMITTED

* 커밋 전의 트랜잭션에서 변경한 데이터를 다른 트랜잭션에서 `읽기` 허용.
* 정합성이 매우 떨어져서 사용을 권장하지 않는다.

```Dirty Read, Non-Repeatable Read 발생, Phantom Read 발생```

<br>

### 2. READ-COMMITTED

* 트랜잭션에서 커밋이 완료된 변경사항만 다른 트랜잭션에서 `읽기` 허용.
* 대부분 RDB에서 기본적으로 사용되고 있는 격리 수준
* 실제 테이블의 데이터를 가져오지 않고, Undo 영역에 백업된 레코드를 가져온다.

```Non-Repeatable Read, Phantom Read 현상 발생```

<br>

### 3. REPEATABLE-READ

* 트랜잭션 범위 내에서 조회한 내용이 항상 동일함을 보장
* 트랜잭션 마다 순서대로 트랜잭션 ID를 부여하고, 트랜잭션 ID보다 작은 트랜잭션 ID에서 변경한 것만 조회가 가능하다.
* 만약 조회했을 때 트랜잭션ID가 더 크다면, Undo영역에서 변경전 데이터를 조회한다. 

``` Phantom Read 현상 발생```

<br>

### 4. SERIALIZABLE

* 한 트랜잭션에서 사용하는 데이터는 다른 트랜잭션에서 `접근 불가`
* 동시처리가 거의 불가능해서 권장하지 않는다.
* 트랜잭션의 ACID 성질이 가장 잘 지켜지지만, 성능은 가장 떨어진다.

<br>

<hr>

# * 참고 - 부정합 문제

### 1. Dirty Read

트랜잭션이 완료되지 않았는데도 다른 트랜잭션에서 조회할 수 있는 현상
> `A트랜잭션`에서 변경한 데이터를 커밋하기 전에 `B트랜잭션`에서 읽어왔을 경우,<br>
> `A트랜잭션` 커밋 전에 롤백해도 `B트랜잭션`에 이미 조회한 데이터는 롤백되지 않는 문제

<br>

### 2. Non-Repeatable Read

같은 트랜잭션 내에서 동일한 SELECT 쿼리로 여러번 조회했을 때, 조회된 데이터가 다른 `데이터 불일치` 문제

<br>

### 3. Phantom Read

같은 트랜잭션 내에서 동일한 SELECT 쿼리로 여러번 조회했을 때, 존재하지 않던 데이터가 어느순간 나타나는 현상.

<hr>